@for (row of data(); track row.id; let idxRow = $index) {
	<tr ssTr>
		@for (column of visibleColumns(); track column.id) {
			@if (!column.subColumns?.length && !column.subGroups?.length) {
				<td
					*ssCell="column.id"
					ssTd
					class="item-td"
				>
					@if (column.id === 'tov') {
						<div
							class="item-tov"
							(click)="
								getRowCheckboxControl(idxRow).setValue(
									!getRowCheckboxControl(idxRow).value
								)
							"
						>
							<ss-lib-checkbox
								[formControl]="getRowCheckboxControl(idxRow)"
								(click)="$event.stopPropagation()"
							></ss-lib-checkbox>
							<ss-lib-text
								class="item-tov__text"
								[lineClampCount]="3"
								[isLineClamp]="true"
								[type]="TextType.BodySm"
								[weight]="TextWeight.Regular"
								[align]="Align.Start"
							>
								{{ getCellValue(row, column.id) }}
							</ss-lib-text>
							@if (
								operationPlanState.getHasPermissionAddComments
							) {
								<ss-lib-action-bar
									class="actions"
									[class]="{
										hidden: !row.isComment,
									}"
									[size]="ExtraSize.xxs"
									(click)="$event.stopPropagation()"
								>
									<ss-lib-action-bar-item
										class="tov-link"
										ss-lib-tooltip
										[leftIconConfig]="{
											icon: IconType.LinkExternal01,
										}"
										[tooltipText]="'Перейти к карточке ТП'"
										[position]="TooltipPosition.Top"
										(click)="
											openTovLink(row.tov.linkToDetail)
										"
									/>
									<ss-lib-action-bar-item
										class="comment"
										ss-lib-tooltip
										[leftIconConfig]="{
											icon: IconType.Message,
										}"
										[text]="row.commentCount"
										[popoverTriggerFor]="
											row.isComment
												? addCommentsModal
												: createCommentsModal
										"
										[tooltipText]="
											row.isComment
												? 'Посмотреть комментарии'
												: 'Добавить комментарий'
										"
										[position]="TooltipPosition.Top"
										(click)="
											openCommentsModal(
												row,
												row.isComment
											)
										"
									/>
								</ss-lib-action-bar>
							}
							<ss-lib-dropdown-list
								#createCommentsModal
								[height]="'100%'"
								[width]="'449px'"
							>
								<app-create-comments-modal
									[data]="row"
								></app-create-comments-modal>
							</ss-lib-dropdown-list>
							<ss-lib-dropdown-list
								#addCommentsModal
								[height]="'100%'"
								[width]="'449px'"
							>
								<app-add-comments-modal
									*ngIf="openCommentsRowId === row.id"
									[data]="row"
								></app-add-comments-modal>
							</ss-lib-dropdown-list>
						</div>
					} @else if (
						column.id === 'optimalBatch' ||
						column.id.startsWith('week') ||
						column.id.startsWith('month')
					) {
						<ss-lib-text
							[type]="TextType.BodySm"
							[weight]="TextWeight.Regular"
							[align]="Align.End"
						>
							{{ getCellValue(row, column.id) }}
						</ss-lib-text>
					} @else if (
						column.id.startsWith('planQuantity') ||
						column.id.startsWith('factQuantity')
					) {
						<app-operation-plan-table-quantity-cell
							[hasUtilityAccess]="
								column.id.startsWith('planQuantity') &&
								!row.isPersonification
							"
							[hasPostponeAccess]="
								!!(
									operationPlanState.getHasPermissionEdit &&
									getDayCell(row, column.id)
										?.isManufactoryOrder
								)
							"
							[hasQuantityEditAccess]="
								operationPlanState.getHasPermissionEdit &&
								!row.isPersonification
							"
							[value]="getCellValue(row, column.id)"
							[row]="row"
							[columnId]="column.id"
						></app-operation-plan-table-quantity-cell>
					} @else {
						<ss-lib-text
							[type]="TextType.BodySm"
							[weight]="TextWeight.Regular"
							[align]="Align.Start"
						>
							{{ getCellValue(row, column.id) }}
						</ss-lib-text>
					}
				</td>
			}
		}
	</tr>
}
