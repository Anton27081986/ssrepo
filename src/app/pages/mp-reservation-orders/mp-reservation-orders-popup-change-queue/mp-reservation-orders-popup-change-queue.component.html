<div
	class="wrapper"
	(mousedown)="close()"
>
	<snab-card
		class="change-queue-form"
		[headerRef]="header"
		[bodyRef]="body"
		(mousedown)="$event.stopPropagation()"
	>
		<ng-template #header>
			<div class="header">
				<snab-text
					[type]="TextType.Title"
					[weight]="TextWeight.Medium"
				>
					Изменить очередь заказов
				</snab-text>
				<snab-button
					[type]="ButtonType.Flat"
					[size]="Size.Large"
					[icon]="IconType.ClearLarge"
					[iconPosition]="IconPosition.OnlyIcon"
					(click)="close()"
				></snab-button>
			</div>
		</ng-template>
		<ng-template #body>
			<div class="content">
				<div class="search-row">
					<div class="search-row__input">
						<ss-search-input
							label="ТП"
							size="medium"
							searchType="tovsManufacturing"
							class="search-row__input__field"
							[reSizeHeightOptions]="true"
							[placeholder]="'Выберите товарную позицию'"
							(select)="onTovFilter($event)"
						/>
						<snab-button
							text="Найти заказы"
							[size]="Size.Large"
							(click)="findQueueOrders()"
						></snab-button>
					</div>
					<div class="search-row__status">
						<snab-form-field
							[label]="'Статус'"
							[size]="Size.Large"
						>
							<snab-select
								fieldCtrl
								[formControl]="status"
								[options]="statusOptions()"
								[placeholder]="'Введите статус'"
							/>
						</snab-form-field>
						<ss-lib-icon
							*ngIf="status.value"
							[width]="'16'"
							[height]="'16'"
							[style.cursor]="'pointer'"
							[icon]="IconTypeNew.Close"
							(click)="status.setValue(null)"
						></ss-lib-icon>
					</div>
				</div>
				<div class="table-container">
					<table class="orders-table">
						<thead>
							<tr>
								<th></th>
								<th>
									<snab-text
										[type]="TextType.Title"
										[weight]="TextWeight.Semibold"
									>
										Код заказа
									</snab-text>
								</th>
								<th>
									<snab-text
										[type]="TextType.Title"
										[weight]="TextWeight.Semibold"
									>
										Статус
									</snab-text>
								</th>
								<th>
									<snab-text
										[type]="TextType.Title"
										[weight]="TextWeight.Semibold"
									>
										Позиция
									</snab-text>
								</th>
								<th>
									<snab-text
										[type]="TextType.Title"
										[weight]="TextWeight.Semibold"
									>
										Кол-во
									</snab-text>
								</th>
								<th>
									<snab-text
										[type]="TextType.Title"
										[weight]="TextWeight.Semibold"
									>
										Ед. изм.
									</snab-text>
								</th>
								<th>
									<snab-text
										[type]="TextType.Title"
										[weight]="TextWeight.Semibold"
									>
										ТП
									</snab-text>
								</th>
								<th>
									<snab-text
										[type]="TextType.Title"
										[weight]="TextWeight.Semibold"
									>
										Заказчик
									</snab-text>
								</th>
								<th>
									<snab-text
										[type]="TextType.Title"
										[weight]="TextWeight.Semibold"
									>
										Клиент
									</snab-text>
								</th>
								<th>
									<snab-text
										[type]="TextType.Title"
										[weight]="TextWeight.Semibold"
									>
										Дата создания
									</snab-text>
								</th>
							</tr>
						</thead>
						<tbody>
							<tr
								*ngFor="
									let queueOrder of filteredOrdersQueue;
									let i = index
								"
								ssDraggableOrderRow
								[queueOrder]="queueOrder"
								[index]="i"
								(reorder)="onOrderReorder($event)"
							>
								<td>
									<snab-button
										[type]="ButtonType.Flat"
										[icon]="IconType.Drag"
										[iconPosition]="IconPosition.OnlyIcon"
										[size]="Size.Large"
									></snab-button>
								</td>
								<td>
									<snab-text [type]="TextType.Body">
										{{ queueOrder.id }}
									</snab-text>
								</td>
								<td>
									<snab-text [type]="TextType.Body">
										{{ queueOrder.status }}
									</snab-text>
								</td>
								<td>
									<snab-text [type]="TextType.Body">
										{{ queueOrder.position }}
									</snab-text>
								</td>
								<td>
									<snab-text [type]="TextType.Body">
										{{
											queueOrder.personificationOrder
												.totalAmount
										}}
									</snab-text>
								</td>
								<td>
									<snab-text [type]="TextType.Body">
										{{
											queueOrder.personificationOrder
												.tovUnit
										}}
									</snab-text>
								</td>
								<td>
									<snab-text [type]="TextType.Body">
										{{
											queueOrder.personificationOrder.tov
												.name
										}}
									</snab-text>
								</td>
								<td>
									<snab-text [type]="TextType.Body">
										{{
											queueOrder.personificationOrder
												.author?.name
										}}
									</snab-text>
								</td>
								<td>
									<snab-text [type]="TextType.Body">
										{{
											queueOrder.personificationOrder
												.client?.name
										}}
									</snab-text>
								</td>
								<td>
									<snab-text [type]="TextType.Body">
										{{
											queueOrder.personificationOrder
												.dateCreated
												| date: 'dd.MM.yyyy'
										}}
									</snab-text>
								</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</ng-template>
	</snab-card>
</div>
