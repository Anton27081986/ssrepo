<div class="wrapper">
	<div class="victory-modal" *ngIf="victory$ | async as victory">
		<div class="victory-modal__header">
			<ss-text size="1"> Победа № {{ victory.id }}</ss-text>
			<ss-icon style="cursor: pointer;" [name]="'close'" (click)="close()"></ss-icon>
		</div>
		<ss-divider></ss-divider>
		<div class="victory-modal__body">
			<app-user-card [viewPopupInfo]="true" [size]="'large'" [user]="victory.user!"></app-user-card>
			<div class="victory-modal__group" *ngIf="victory.groupWinUsers">
				<app-user-card [viewPopupInfo]="true" [size]="'small'" *ngFor="let user of victory.groupWinUsers"
							   [user]="user"></app-user-card>
			</div>
			<div class="victory-modal__actions">
				<app-like *ngIf="!(isExtendedMode$ | async)" [likedUsers]="victory.likedUsers || []"
						  [type]="(typeLike$ | async)!" [count]="victory.likesCount!"
						  (click)="changeLike(victory.isUserLiked!)"></app-like>
				<div class="victory-modal__isExtendedMode">
					<app-choice-like (close)="isChoiceLike.next(false)" *ngIf="isChoiceLike |async"
									 (stateLike)="getLike(victory.isUserLiked!,$event)"></app-choice-like>
					<app-like
						*ngIf="isExtendedMode$ | async"
						[likedUsers]="victory.likedUsers || []"
						[type]="(typeLike$ | async)!"
						[count]="victory.likesCount!"
						(click)="openChoiceLike(victory)">
					</app-like>
				</div>
			</div>
		</div>
		<ss-divider></ss-divider>
		<ng-container *ngIf="comments$ | async as comments">
			<div class="victory-modal__comments">
				<ss-text class="victory-modal__description-comment" size="1">Комментарии:</ss-text>
				<ng-container *ngIf="comments.total > 0">
					<app-victory-comment (updateComment)="updateComment($event)" *ngFor="let comment of comments.items"
										 [comment]="comment"></app-victory-comment>
					<ss-divider></ss-divider>
				</ng-container>
				<ng-container *ngIf="comments.total === 0">
					<div class="victory-modal__no-comments">
						<ss-empty-placeholder>
							<ss-icon name="empty"></ss-icon>
							<ss-headline size="h3">Ни одного комментария</ss-headline>
							<ss-text color="gray" size="3">Будьте среди первых, кто оставит комментарий</ss-text>
						</ss-empty-placeholder>
					</div>
				</ng-container>
			</div>
		</ng-container>
		<ss-divider></ss-divider>
		<div class="victory-modal__footer">
			<ss-form-control-input-with-func-edit (cancelEditing)="cancelEditing()" [funcEdit]="(funcEdit$ | async)!" [control]="notes"
					  [placeholder]="'Оставить комментарий'"></ss-form-control-input-with-func-edit>
			<ss-button [size]="'small'" (click)="addOrUpdateComment(victory.id)">
				<ss-icon [name]="'telegram'"></ss-icon>
			</ss-button>
		</div>
	</div>
</div>
