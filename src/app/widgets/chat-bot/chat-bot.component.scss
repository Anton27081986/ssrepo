@use 'src/styles/colors.scss' as *;

:host {
	position: fixed;
	width: 100vw;
	height: 0;
	top: 53px;
	left: 0;
}

.chat-wrapper.opened {
	height: calc(100vh - 53px);
}

.chat-wrapper {
	width: 100%;
	display: flex;
	justify-content: center;
	background-color: $island;
	height: 0;
	overflow: hidden;
	transition: height 0.5s;
}

.chat {
	position: relative;
	display: flex;
	width: 100%;
	flex-direction: column;
	padding-bottom: 32px;
	align-items: center;
	gap: 16px;
	flex-grow: 1;

	&__header {
		width: 768px;
		display: flex;
		gap: 8px;
		flex-direction: row-reverse;
	}

	&__content {
		display: flex;
		flex-direction: column;
		justify-content: center;
		overflow-y: auto;

		&__title {
			display: flex;
			min-height: 40vh;
			width: 768px;
			text-align: center;
			overflow: hidden;

			::ng-deep p {
				align-self: flex-end;
				line-height: 1 !important;
			}
		}

		&__body {
			display: flex;
			flex-grow: 1;
			align-items: center;
			flex-direction: column;
			width: 100%;
			gap: 12px;
			position: relative;
			overflow-y: auto;

			&__messages {
				display: flex;
				overflow-y: auto;
				flex-direction: column-reverse;
				width: 768px;
				gap: 24px;
				flex-grow: 1;
				min-height: calc(100vh - 264px);

				&__message {
					display: flex;
					flex-direction: column;
					gap: 8px;
					padding: 8px;
					border-radius: 6px;
					overflow-wrap: break-word;
				}

				&__my-message {
					max-width: 376px;
					background-color: #F2F2F2;
					align-self: flex-end;
					margin-right: 16px;

					&__time {
						align-self: flex-end;
					}
				}

				&__bot-message {
					display: flex;
					flex-direction: column;
					gap: 8px;
					max-width: 768px;

					::ng-deep p {
						font-family: 'Inter', serif;
						letter-spacing: -0.01em;
						margin: 0;
						font-size: 12px;
						line-height: 18px;
					}

					&__text {
						background-color: #EDF1FF;

						&__title {
							align-self: flex-start;
						}

						&__time {
							align-self: flex-end;
						}
					}

					&__controls {
						padding: 0 8px;
						display: flex;
						gap: 12px;
						align-items: center;
						align-self: flex-end;

						&__buttons {
							display: flex;
							gap: 6px;
							align-items: center;
							cursor: pointer;

							&__dislike {
								transform: rotateZ(180deg);
							}
						}

						&__icons {
							display: flex;
							gap: 6px;
							align-items: center;

							&__dislike {
								transform: rotateZ(180deg);
							}
						}
					}
				}
			}

			&__loader {
				width: 30px;
				aspect-ratio: 2;
				--_g: no-repeat radial-gradient(circle closest-side,#737373 90%, #0000);
				background:
					var(--_g) 0%   50%,
					var(--_g) 50%  50%,
					var(--_g) 100% 50%;
				background-size: calc(100%/3) 50%;
				animation: loader 1s infinite linear;
			}
		}
	}

	&__footer {
		position: relative;
		display: flex;
		flex-direction: column;
		gap: 8px;

		&__avatar {
			position: absolute;
			bottom: 0;
			left: -160px;
			width: 152px;
		}

		&__subsectors {
			display: flex;
			gap: 16px;

			&__item {
				cursor: pointer;
				color: #416CFF;
				outline: 1px solid #e6e6e6;
				padding: 7px 12px;
				border-radius: 8px;

				&__active {
					outline: 1px solid #416CFF;
				}
			}
		}

		&__form {
			position: relative;
			display: flex;
			width: 100%;
			gap: 8px;
			align-items: center;

			&__input {
				width: 768px;
				display: grid;
				min-height: 64px;
				max-height: 220px;
				overflow: hidden;
				overflow-wrap: anywhere;
			}

			&__input::after {
				content: attr(data-replicated-value) " ";
				white-space: pre-wrap;
				visibility: hidden;
			}

			&__input > textarea {
				resize: none;
				max-height: 220px;
				overflow-y: auto;
				overflow-wrap: anywhere;
				overflow-x: hidden;
				width: 100%;
				height: auto;
				padding: 6px 44px 6px 12px;
				border-radius: 8px;
				border: 1px solid $island-outline;
				background-color: $island;
				outline: none;
				font-family: 'Inter', serif;
				font-size: 14px;
				line-height: 17px;
				letter-spacing: -0.01em;
			}
			&__input > textarea,
			&__input::after {
				font: inherit;
				grid-area: 1 / 1 / 2 / 2;
			}

			&__input > textarea::placeholder {
				color: $lite-text;
			}

			&__input > textarea:focus {
				border-color: $additional-outline;
			}

			&__input > textarea::-webkit-resizer {
				border: none;
			}

			&__button {
				position: absolute;
				right: 12px;
				bottom: 6px;
			}
		}
	}
}

@keyframes loader {
	20%{background-position:0%   0%, 50%  50%,100%  50%}
	40%{background-position:0% 100%, 50%   0%,100%  50%}
	60%{background-position:0%  50%, 50% 100%,100%   0%}
	80%{background-position:0%  50%, 50%  50%,100% 100%}
}
